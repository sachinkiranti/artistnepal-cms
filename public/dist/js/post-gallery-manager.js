!function(e){e.fn.filemanager=function(i,a){i=i||"file",this.on("click",function(r){var t=a&&a.prefix?a.prefix:"/filemanager",n=e("#"+e(this).data("input")),l=e("#"+e(this).data("preview"));return window.open(t+"?type="+i,"FileManager","width=900,height=600"),window.SetUrl=function(i){var a=i.map(function(e){return e.url}).join(",");n.val("").val(a).trigger("change"),l.html(""),i.forEach(function(i){l.append(e("<img>").css({height:"5rem",width:"45%"}).attr("src",i.thumb_url))}),l.trigger("change")},!1})}}(jQuery),$(function(){({init:function(){this.cacheDom(),this.bind(),this.initPlugin()},cacheDom:function(){this.$galleryManager=$(".gallery-manager")},bind:function(){$(document).on("click","#lfm",this.showFileManager),this.$galleryManager.on("click",".add-gallery",this.addNewGalleryTr),this.$galleryManager.on("click",".delete-gallery",this.removeGallery)},removeGallery:function(){var e;return(e=$(this)).parents("table").find("tbody tr.gallery-row").length>1&&e.closest("tr").remove(),!1},addNewGalleryTr:function(){var e,i,a,r,t;return(i=(e=$(this).parents("table").find("tbody tr.gallery-row:last")).clone()).find(":input").val(""),i.find("img").attr("src",""),r="thumbnail"+(a=Math.floor(1e5*Math.random()+1)),t="holder"+a,i.find("td > .gallery-media-wrapper :input").attr("id",r),i.find("td > .gallery-media-wrapper a").attr("data-input",r),i.find("td > .gallery-media-wrapper a").attr("data-preview",t),i.find("td > .gallery-media-wrapper .gallery-media-holder").attr("id",t),e.after(i),i.find("td > .gallery-media-wrapper #lfm").click(),!1},showFileManager:function(){$(this).filemanager("image")},initPlugin:function(){$(".dropify").dropify(),$("#lfm").click()}}).init()});
